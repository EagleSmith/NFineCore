<!DOCTYPE html>
<html>
<head>
    <title>Index</title>
    <script src="/lib/jquery/1.12.4/jquery.min.js"></script>
    <script src="~/lib/bootstrap/3.3.7/js/bootstrap.js"></script>
    <link href="~/lib/bootstrap/3.3.7/css/bootstrap.css" rel="stylesheet" />
    <link href="~/lib/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet" />
    <link href="/css/framework-style.css" rel="stylesheet" />
    <script src="~/lib/validation/dist/jquery.validate.js"></script>
    <script src="~/lib/validation/dist/localization/messages_zh.js"></script>
    <script src="~/lib/art-template/lib/template-web.js"></script>
    <script src="~/js/framework-ui.js"></script>
    <script id="ibox-news" type="text/html">
        <div class="ibox">
            <div id="ibox-content-news" class="ibox-content">
                <span class="text-muted small pull-right">最后更新：<i class="fa fa-clock-o"></i> {{LastModificationTime}}</span>
                <h2>图文管理</h2>
                <p>
                    所有客户必须通过邮件验证
                        </p>
                <div class="input-group">
                    <input type="text" placeholder="查找客户" class="input form-control">
                        <span class="input-group-btn">
                            <button type="button" class="btn btn btn-primary"> <i class="fa fa-search"></i> 搜索</button>
                        </span>
                        </div>
                    <div class="clients-list">
                        <ul class="nav nav-tabs">
                            <span class="pull-right small text-muted">1406 个客户</span>
                            <li class="active">
                                <a data-toggle="tab" href="#tab-1"><i class="fa fa-user"></i>图文列表</a>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <div id="tab-1" class="tab-pane active">
                                <div class="full-height-scroll">
                                    <div class="table-responsive">
                                        <table class="table table-striped table-hover">
                                            <tbody>
                                                {{each WxNewsArticles as article index}}
                                                <tr class="news-tr">
                                                    <td class="client-avatar"><img alt="image" src="~/img/a2.jpg"> </td>
                                                    <td> {{article.Title}}</td>
                                                    <td>
                                                        <a class="btn btn-xs btn-white news-up"><i class="fa fa-chevron-up"></i></a>
                                                        <a class="btn btn-xs btn-white news-down"><i class="fa fa-chevron-down"></i></a>
                                                        <a class="btn btn-xs btn-white news-delete"><i class="fa fa-close"></i></a>
                                                    </td>
                                                </tr>
                                                {{/each}}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    </script>
</head>
<body class="gray-bg">
    <div class="wrapper wrapper-content  animated fadeInRight">
        <div class="row">
            <div id="col4" class="col-sm-4">

            </div>
            <div class="col-sm-8">
                <div class="ibox float-e-margins">
                    @*<div class="ibox-title">
                            <h5>所有表单元素 <small>包括自定义样式的复选和单选按钮</small></h5>
                            <div class="ibox-tools">
                                <a class="collapse-link">
                                    <i class="fa fa-chevron-up"></i>
                                </a>
                                <a class="dropdown-toggle" data-toggle="dropdown" href="form_basic.html#">
                                    <i class="fa fa-wrench"></i>
                                </a>
                                <ul class="dropdown-menu dropdown-user">
                                    <li>
                                        <a href="form_basic.html#">选项1</a>
                                    </li>
                                    <li>
                                        <a href="form_basic.html#">选项2</a>
                                    </li>
                                </ul>
                                <a class="close-link">
                                    <i class="fa fa-times"></i>
                                </a>
                            </div>
                        </div>*@
                    <div class="ibox-content">
                        <span class="text-muted small pull-right">最后更新：<i class="fa fa-clock-o"></i> 2015-09-01 12:00</span>
                        <h2>客户管理</h2>
                        <p>
                            所有客户必须通过邮件验证
                        </p>
                        <form method="get" class="form-horizontal">
                            <div class="form-group">
                                <label class="col-sm-2 control-label">标题</label>

                                <div class="col-sm-10">
                                    <input class="form-control" type="text">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label">封面</label>
                                <div class="col-sm-10">
                                    <input class="form-control" type="text"> <span class="help-block m-b-none">帮助文本，可能会超过一行，以块级元素显示</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label">作者</label>
                                <div class="col-sm-10">
                                    <input class="form-control" type="text"> <span class="help-block m-b-none">帮助文本，可能会超过一行，以块级元素显示</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label">内容</label>

                                <div class="col-sm-10">
                                    <input class="form-control" name="password" type="text">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label">摘要</label>

                                <div class="col-sm-10">
                                    <input placeholder="" class="form-control" type="text">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label">原文链接</label>

                                <div class="col-sm-10">
                                    <input placeholder="" class="form-control" type="text">
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        var keyValue = $.request("keyValue");
        $(function () {
            //initControl();
            if (!!keyValue) {
                $.ajax({
                    url: "/WeixinManage/WxNews/GetFormJson",
                    data: { keyValue: keyValue },
                    dataType: "json",
                    async: false,
                    success: function (data) {
                        console.log(data);
                        var html = template('ibox-news', data);
                        document.getElementById('col4').innerHTML = html;
                    }
                });
            }

            $('.news-up').bind('click', function () {
                var tr = $(this).closest('tr'); //获取当前<tr>
                var prev = tr.prev();  //获取当前<tr>前一个元素
                if (tr.index() > 0) {
                    tr.insertBefore(prev); //插入到当前<tr>前一个元素前
                } 
            })
            $('.news-down').bind('click', function () {
                var tr = $(this).closest('tr'); //获取当前<tr>
                var next = tr.next(); //获取当前<tr>后面一个元素
                if (next) {
                    tr.insertAfter(next);  //插入到当前<tr>后面一个元素后面
                } 
            })
            $('.news-delete').bind('click', function () {
                var trs = $('.news-tr');
                if (trs.length > 1) {
                    $(this).closest('tr').remove();
                }
            })
        });
        function initControl() {
            var data = {
                title: '基本例子',
                isAdmin: true,
                list: ['文艺', '博客', '摄影', '电影', '民谣', '旅行', '吉他']
            };
            var html = template('test', data);
            document.getElementById('news-tbody').innerHTML = html;
        }
    </script>
</body>
</html>
